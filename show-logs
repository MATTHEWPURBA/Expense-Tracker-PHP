#!/bin/bash

###############################################################################
# Expense Tracker - Show Logs Command
# Show application logs and errors
###############################################################################

# Colors for output
GREEN='\033[0;32m'
RED='\033[0;31m'
CYAN='\033[0;36m'
YELLOW='\033[1;33m'
NC='\033[0m' # No Color

# Project directory
PROJECT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
cd "$PROJECT_DIR"

echo -e "${CYAN}ðŸ’° Expense Tracker - Application Logs${NC}"
echo ""

# Check if logs directory exists
if [ ! -d "logs" ]; then
    echo -e "${YELLOW}No logs directory found${NC}"
    exit 0
fi

# Show error logs
if [ -f "logs/error.log" ]; then
    echo -e "${RED}=== ERROR LOGS ===${NC}"
    if [ -s "logs/error.log" ]; then
        tail -20 logs/error.log
    else
        echo -e "${GREEN}No errors found${NC}"
    fi
    echo ""
fi

# Show login attempt logs
if [ -f "logs/login_attempts.log" ]; then
    echo -e "${YELLOW}=== LOGIN ATTEMPTS ===${NC}"
    if [ -s "logs/login_attempts.log" ]; then
        tail -10 logs/login_attempts.log
    else
        echo -e "${GREEN}No login attempts logged${NC}"
    fi
    echo ""
fi

# Show server status
echo -e "${CYAN}=== SERVER STATUS ===${NC}"
if curl -s -o /dev/null -w "%{http_code}" http://localhost:8000 > /dev/null 2>&1; then
    echo -e "${GREEN}âœ“ Server is running at http://localhost:8000${NC}"
else
    echo -e "${RED}âœ— Server is not running${NC}"
fi

echo ""
echo -e "${CYAN}Tip: Run './serve' to start the server and see live logs${NC}"
